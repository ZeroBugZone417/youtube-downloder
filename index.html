<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULTIMATE DOWNLOADER | BLACK MATRIX DEV</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Montserrat:wght@300;400;600&display=swap');
        :root { --primary-color: #ff0000; --text-glow: #ff0000; }
        body { font-family: 'Montserrat', sans-serif; background: #000; color: white; min-height: 100vh; }
        h1, h2 { font-family: 'Orbitron', sans-serif; }
        .glow { text-shadow: 0 0 10px var(--text-glow); }
        .btn-glow { transition: all 0.3s ease; box-shadow: 0 0 10px rgba(255,0,0,0.4); }
        .btn-glow:hover { transform: translateY(-2px); box-shadow: 0 0 20px rgba(255,0,0,0.7); }
        .result-card { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border-radius: 15px; border: 1px solid rgba(255,0,0,0.2); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #ff0000; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .tab-active { border-bottom: 3px solid #ff0000; color: #ff0000; }
    </style>
</head>
<body class="p-4 md:p-10">

    <header class="text-center mb-10">
        <h1 class="text-3xl md:text-5xl font-bold glow mb-2 uppercase tracking-tighter">Black Matrix DL</h1>
        <p class="text-gray-400 text-sm">Universal YouTube & TikTok Downloader</p>
    </header>

    <div class="max-w-md mx-auto flex justify-center gap-8 mb-8 border-b border-white/10 pb-2">
        <button onclick="switchMode('youtube')" id="yt-tab" class="font-bold tab-active transition-all">YOUTUBE</button>
        <button onclick="switchMode('tiktok')" id="tt-tab" class="font-bold text-gray-500 transition-all">TIKTOK</button>
    </div>

    <div class="max-w-2xl mx-auto flex flex-col md:flex-row gap-3 mb-10">
        <input type="text" id="urlInput" placeholder="Paste YouTube Link..." 
               class="flex-grow px-4 py-4 rounded-lg bg-gray-900 border border-gray-700 text-white focus:outline-none focus:border-red-500 transition-all">
        <button onclick="processDownload()" id="btnText" 
                class="px-8 py-4 bg-red-600 hover:bg-red-700 rounded-lg font-bold btn-glow flex items-center justify-center">
            DOWNLOAD
        </button>
    </div>

    <div id="loading" class="hidden flex justify-center mb-10"><div class="loader"></div></div>

    <div id="resultArea" class="hidden max-w-3xl mx-auto">
        <div class="result-card p-6 flex flex-col md:flex-row gap-6">
            <div class="md:w-1/3">
                <img id="thumb" src="" class="rounded-lg w-full shadow-2xl border border-white/10">
            </div>
            <div class="md:w-2/3">
                <span id="platformTag" class="text-[10px] font-bold px-2 py-1 rounded mb-2 inline-block"></span>
                <h2 id="videoTitle" class="text-xl font-bold mb-4 line-clamp-2 uppercase">Video Title</h2>
                <div id="downloadButtons" class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    </div>
            </div>
        </div>
    </div>

    <script>
        let currentMode = 'youtube';

        function switchMode(mode) {
            currentMode = mode;
            document.getElementById('urlInput').placeholder = mode === 'youtube' ? "Paste YouTube Link..." : "Paste TikTok Link...";
            document.getElementById('yt-tab').className = mode === 'youtube' ? 'font-bold tab-active' : 'font-bold text-gray-500';
            document.getElementById('tt-tab').className = mode === 'tiktok' ? 'font-bold tab-active' : 'font-bold text-gray-500';
            document.getElementById('resultArea').classList.add('hidden');
        }

        async function processDownload() {
            const input = document.getElementById('urlInput').value;
            const btnText = document.getElementById('btnText');
            const loader = document.getElementById('loading');
            const resultArea = document.getElementById('resultArea');

            if (!input) return alert("Please paste a link first!");

            btnText.disabled = true;
            btnText.textContent = "Fetching...";
            loader.classList.remove('hidden');
            resultArea.classList.add('hidden');

            try {
                if (currentMode === 'youtube') {
                    const baseUrl = `https://www.movanest.xyz/v2/ytdl2?input=${encodeURIComponent(input)}`;
                    // YouTube වලට metadata ගන්න වෙනම API එකක් නැති නිසා placeholder එකක් දමමි
                    renderResults("YouTube Video Content", "https://img.youtube.com/vi/placeholder/hqdefault.jpg", [
                        { text: "360p (MP4)", url: baseUrl + "&format=360p", color: "bg-gray-800" },
                        { text: "720p (HD)", url: baseUrl + "&format=720p", color: "bg-blue-600" },
                        { text: "1080p (FHD)", url: baseUrl + "&format=1080p", color: "bg-red-600" },
                        { text: "Audio (MP3)", url: baseUrl + "&format=audio", color: "bg-purple-600" }
                    ], "YOUTUBE", "bg-red-600 text-white");
                    
                } else {
                    const ttApiUrl = `https://www.movanest.xyz/v2/tiktok?input=${encodeURIComponent(input)}`;
                    renderResults("TikTok Video Content", "https://placehold.co/400x600/000/fff?text=TikTok+Video", [
                        { text: "No Watermark", url: ttApiUrl, color: "bg-green-600" },
                        { text: "Download Audio", url: ttApiUrl + "&format=audio", color: "bg-gray-800" }
                    ], "TIKTOK", "bg-pink-600 text-white");
                }
            } catch (error) {
                alert("Something went wrong. Check link!");
            } finally {
                btnText.disabled = false;
                btnText.textContent = "DOWNLOAD";
                loader.classList.add('hidden');
            }
        }

        function renderResults(title, thumbnail, buttons, tagText, tagClass) {
            const resultArea = document.getElementById('resultArea');
            document.getElementById('videoTitle').textContent = title;
            document.getElementById('thumb').src = thumbnail;
            
            const tag = document.getElementById('platformTag');
            tag.textContent = tagText;
            tag.className = `text-[10px] font-bold px-2 py-1 rounded mb-2 inline-block ${tagClass}`;
            
            const btnContainer = document.getElementById('downloadButtons');
            btnContainer.innerHTML = ''; 

            buttons.forEach(btn => {
                const a = document.createElement('a');
                a.href = btn.url;
                a.target = "_blank";
                a.textContent = btn.text;
                a.className = `text-center ${btn.color} hover:opacity-80 text-white py-3 rounded-lg font-bold transition-all text-sm uppercase`;
                btnContainer.appendChild(a);
            });

            resultArea.classList.remove('hidden');
        }
    </script>
</body>
</html>
